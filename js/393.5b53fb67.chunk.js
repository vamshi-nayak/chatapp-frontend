"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[393],{9393:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var r,s,a=n(885),i=n(2791),o=n(7294),c=n(5861),l=n(7757),d=n.n(l),u=n(4736),x=n(8735),p=n(2818),h=n(4569),f=n.n(h),m=function(e,t){return t[0]._id===e._id?t[1].name:t[0].name},g=function(e,t,n,r){return n<e.length-1&&e[n+1].sender._id===t.sender._id&&e[n].sender._id!==r?33:n<e.length-1&&e[n+1].sender._id!==t.sender._id&&e[n].sender._id!==r||n===e.length-1&&e[n].sender._id!==r?0:"auto"},j=function(e,t,n){return n>0&&e[n-1].sender._id===t.sender._id},k=function(e,t,n,r){return n<e.length-1&&(e[n+1].sender._id!==t.sender._id||void 0===e[n+1].sender._id)&&e[n].sender._id!==r},b=function(e,t,n){return t===e.length-1&&e[e.length-1].sender._id!==n&&e[e.length-1].sender._id},v=n(7718),C=n(184),y=function(){return(0,C.jsxs)(x.Kq,{children:[(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"}),(0,C.jsx)(v.Od,{height:"45px"})]})},_=n(2982),w=n(5223),S=n(3663),E=n(3393),Z=n(5798),A=n(2504),F=function(e){e.admin;var t=e.user,n=e.handleFunction;return(0,C.jsxs)(x.Ct,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:n,children:[t.name,(0,C.jsx)(u.Tw,{pl:1})]})},z=n(9686),O=function(e){var t=e.user,n=e.handleFunction;return(0,C.jsxs)(x.xu,{onClick:n,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg",children:[(0,C.jsx)(z.qE,{mr:2,size:"sm",cursor:"pointer",name:t.name}),(0,C.jsxs)(x.xu,{children:[(0,C.jsx)(x.xv,{children:t.name}),(0,C.jsxs)(x.xv,{fontSize:"xs",children:[" ",(0,C.jsx)("b",{children:"Email : "})," ",t.email," "]})]})]})},I=function(e){var t=e.children,n=(0,i.useState)(),r=(0,a.Z)(n,2),s=r[0],l=r[1],u=(0,i.useState)([]),h=(0,a.Z)(u,2),m=h[0],g=h[1],j=(0,i.useState)(""),k=(0,a.Z)(j,2),b=k[0],v=k[1],y=(0,i.useState)([]),z=(0,a.Z)(y,2),I=z[0],B=z[1],N=(0,i.useState)(!1),D=(0,a.Z)(N,2),W=D[0],G=D[1],L=(0,i.useContext)(o.Z),R=L.user,q=L.chats,U=L.setChats,V=(0,p.pm)(),M=(0,w.qY)(),P=M.isOpen,T=M.onOpen,Y=M.onClose,K=function(){var e=(0,c.Z)(d().mark((function e(t){var n,r,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,G(!0),n={headers:{Authorization:"Bearer ".concat(R.token)}},e.next=8,f().get("/api/user?search=".concat(b),n);case 8:r=e.sent,s=r.data,console.log(s,"users search response from server"),G(!1),B(s),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),console.error(e.t0.message),V({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:3e3,isClosable:!0,position:"bottom-left"});case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,c.Z)(d().mark((function e(){var t,n,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&m){e.next=3;break}return V({title:"Please fill all the feilds",status:"warning",duration:3e3,isClosable:!0,position:"top"}),e.abrupt("return");case 3:return e.prev=3,t={headers:{Authorization:"Bearer ".concat(R.token)}},e.next=7,f().post("/api/chat/group",{name:s,users:JSON.stringify(m.map((function(e){return e._id})))},t);case 7:n=e.sent,r=n.data,U([r].concat((0,_.Z)(q))),console.log(r,"group chat added/created respopnse"),Y(),V({title:"New Group Chat Created!",status:"success",duration:3e3,isClosable:!0,position:"bottom"}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),console.error(e.t0.message),V({title:"Failed to Create the Chat!",description:e.t0.response.data,status:"error",duration:3e3,isClosable:!0,position:"bottom"});case 19:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}();return(0,C.jsxs)(i.Fragment,{children:[(0,C.jsx)("span",{onClick:T,children:t}),(0,C.jsxs)(S.u_,{onClose:Y,isOpen:P,isCentered:!0,children:[(0,C.jsx)(S.ZA,{}),(0,C.jsxs)(S.hz,{children:[(0,C.jsx)(S.xB,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:"Create Group Chat"}),(0,C.jsx)(S.ol,{}),(0,C.jsxs)(S.fe,{d:"flex",flexDir:"column",alignItems:"center",children:[(0,C.jsx)(E.NI,{children:(0,C.jsx)(Z.II,{placeholder:"Chat Name",mb:3,onChange:function(e){return l(e.target.value)}})}),(0,C.jsx)(E.NI,{children:(0,C.jsx)(Z.II,{placeholder:"Add Users eg: Kohli, Ganguli, Dhoni",mb:1,onChange:function(e){return K(e.target.value)}})}),(0,C.jsx)(x.xu,{w:"100%",d:"flex",flexWrap:"wrap",children:m.map((function(e){return(0,C.jsx)(F,{user:e,handleFunction:function(){return t=e,void g(m.filter((function(e){return e._id!==t._id})));var t}},e._id)}))}),W?(0,C.jsx)("div",{children:"Loading..."}):null===I||void 0===I?void 0:I.slice(0,4).map((function(e){return(0,C.jsx)(O,{user:e,handleFunction:function(){return t=e,void(m.includes(t)?V({title:"User already added",status:"warning",duration:3e3,isClosable:!0,position:"top"}):g([].concat((0,_.Z)(m),[t])));var t}},e._id)}))]}),(0,C.jsx)(S.mz,{children:(0,C.jsx)(A.zx,{onClick:J,colorScheme:"blue",children:"Create Chat"})})]})]})]})},B=function(e){var t=e.fetchAgain,n=(0,i.useState)(),r=(0,a.Z)(n,2),s=r[0],l=r[1],h=(0,i.useContext)(o.Z),g=h.selectedChat,j=h.setSelectedChat,k=h.user,b=h.chats,v=h.setChats,_=(0,p.pm)(),w=function(){var e=(0,c.Z)(d().mark((function e(){var t,n,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={headers:{Authorization:"Bearer ".concat(k.token)}},e.next=4,f().get("/api/chat",t);case 4:n=e.sent,r=n.data,v(r),console.log(r,"fetching all users chats in my chats"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0.message),_({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:3e3,isClosable:!0,position:"bottom-left"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){l(JSON.parse(localStorage.getItem("userInformation"))),w()}),[t]),(0,C.jsxs)(x.xu,{d:{base:g?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,bg:"white",w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px",children:[(0,C.jsxs)(x.xu,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",d:"flex",w:"100%",justifyContent:"space-between",alignItems:"center",children:["My Chats",(0,C.jsx)(I,{children:(0,C.jsx)(A.zx,{d:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:(0,C.jsx)(u.dt,{}),children:"New Group Chat"})})]}),(0,C.jsx)(x.xu,{d:"flex",flexDir:"column",p:3,bg:"#F8F8F8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:b?(0,C.jsx)(x.Kq,{overflowY:"scroll",children:b.map((function(e,t){return(0,C.jsx)(x.xu,{onClick:function(){return j(e)},cursor:"pointer",bg:g===e?"#38B2AC":"#E8E8E8",color:g===e?"white":"black",px:3,py:2,borderRadius:"lg",children:(0,C.jsx)(x.xv,{children:e.isGroupChat?e.chatName:m(s,e.users)})},e._id)}))}):(0,C.jsx)(y,{})})]})},N=n(2213),D=function(e){var t=e.user,n=e.children,r=(0,w.qY)(),s=r.isOpen,a=r.onOpen,o=r.onClose;return(0,C.jsxs)(i.Fragment,{children:[n?(0,C.jsx)("span",{onClick:a,children:n}):(0,C.jsx)(A.hU,{d:{base:"flex"},icon:(0,C.jsx)(u.ON,{}),onClick:a}),(0,C.jsxs)(S.u_,{size:"lg",onClose:o,isOpen:s,isCentered:!0,children:[(0,C.jsx)(S.ZA,{}),(0,C.jsxs)(S.hz,{h:"380px",bg:"purple.800",children:[(0,C.jsx)(S.xB,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center",fontWeight:"bold",color:"yellow.400",children:t.name}),(0,C.jsx)(S.ol,{}),(0,C.jsxs)(S.fe,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between",children:[(0,C.jsx)(z.qE,{size:"2xl",name:t.name,borderColor:"black",borderWidth:"2px",bg:"yellow.400",color:"black"}),(0,C.jsxs)(x.xv,{fontSize:{base:"28px",md:"30px"},fontWeight:"bold",color:"yellow.400",fontFamily:"Work sans",children:["Email: ",t.email]})]}),(0,C.jsx)(S.mz,{children:(0,C.jsx)(A.zx,{onClick:o,colorScheme:"red",children:"Close"})})]})]})]})},W=n(1070),G=n(8385),L=function(e){var t=e.messages,n=(0,i.useContext)(o.Z).user;return(0,C.jsx)(G.Z,{children:t&&t.map((function(e,r){return(0,C.jsxs)("div",{style:{display:"flex"},children:[(k(t,e,r,n._id)||b(t,r,n._id))&&(0,C.jsx)(W.u,{label:e.sender.name,placement:"bottom-start",hasArrow:!0,children:(0,C.jsx)(z.qE,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name})}),(0,C.jsx)("span",{style:{backgroundColor:"".concat(e.sender._id===n._id?"#BEE3F8":"#B9F5D0"),marginLeft:g(t,e,r,n._id),marginTop:j(t,e,r,n._id)?3:10,borderRadius:"20px",padding:"5px 15px",maxWidth:"75%"},children:e.content})]},e._id)}))})},R=function(e){var t=e.fetchAgain,n=e.setFetchAgain,r=e.fetchMessages,s=(0,w.qY)(),l=s.isOpen,h=s.onOpen,m=s.onClose,g=(0,i.useState)(),j=(0,a.Z)(g,2),k=j[0],b=j[1],v=(0,i.useState)(""),y=(0,a.Z)(v,2),_=y[0],z=y[1],I=(0,i.useState)([]),B=(0,a.Z)(I,2),D=B[0],W=B[1],G=(0,i.useState)(!1),L=(0,a.Z)(G,2),R=L[0],q=L[1],U=(0,i.useState)(!1),V=(0,a.Z)(U,2),M=V[0],P=V[1],T=(0,p.pm)(),Y=(0,i.useContext)(o.Z),K=Y.selectedChat,J=Y.setSelectedChat,$=Y.user,Q=function(){var e=(0,c.Z)(d().mark((function e(t){var n,r,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z(t),t){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,q(!0),n={headers:{Authorization:"Bearer ".concat($.token)}},e.next=8,f().get("/api/user?search=".concat(_),n);case 8:r=e.sent,s=r.data,console.log(s,"user search response"),q(!1),W(s),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(3),console.log(e.t0.message),T({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:3e3,isClosable:!0,position:"bottom-left"}),q(!1);case 20:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=(0,c.Z)(d().mark((function e(){var r,s,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,P(!0),r={headers:{Authorization:"Bearer ".concat($.token)}},e.next=7,f().put("/api/chat/rename",{chatId:K._id,chatName:k},r);case 7:s=e.sent,a=s.data,console.log(a._id,a,"renaming group chat resposne"),J(a),n(!t),P(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),T({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:3e3,isClosable:!0,position:"bottom"}),P(!1);case 19:b("");case 20:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=(0,c.Z)(d().mark((function e(r){var s,a,i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!K.users.find((function(e){return e._id===r._id}))){e.next=3;break}return T({title:"User Already in group!",status:"error",duration:3e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:if(K.groupAdmin._id===$._id){e.next=6;break}return T({title:"Only admins can add someone!",status:"error",duration:3e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 6:return e.prev=6,q(!0),s={headers:{Authorization:"Bearer ".concat($.token)}},e.next=11,f().put("/api/chat/groupadd",{chatId:K._id,userId:r._id},s);case 11:a=e.sent,i=a.data,J(i),console.log(i,"added user data response"),n(!t),q(!1),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(6),console.log(e.t0.message),T({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:3e3,isClosable:!0,position:"bottom"}),q(!1);case 24:b("");case 25:case"end":return e.stop()}}),e,null,[[6,19]])})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,c.Z)(d().mark((function e(s){var a,i,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K.groupAdmin._id===$._id||s._id===$._id){e.next=3;break}return T({title:"Only admins can remove someone!",status:"error",duration:3e3,isClosable:!0,position:"bottom"}),e.abrupt("return");case 3:return e.prev=3,q(!0),a={headers:{Authorization:"Bearer ".concat($.token)}},e.next=8,f().put("/api/chat/groupremove",{chatId:K._id,userId:s._id},a);case 8:i=e.sent,o=i.data,s._id===$._id?J():J(o),n(!t),r(),q(!1),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(3),console.log(e.t0.message),T({title:"Error Occured!",description:e.t0.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"bottom"}),q(!1);case 21:b("");case 22:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(A.hU,{d:{base:"flex"},icon:(0,C.jsx)(u.ON,{}),onClick:h}),(0,C.jsxs)(S.u_,{onClose:m,isOpen:l,isCentered:!0,children:[(0,C.jsx)(S.ZA,{}),(0,C.jsxs)(S.hz,{children:[(0,C.jsx)(S.xB,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center",children:K.chatName}),(0,C.jsx)(S.ol,{}),(0,C.jsxs)(S.fe,{d:"flex",flexDir:"column",alignItems:"center",children:[(0,C.jsx)(x.xu,{w:"100%",d:"flex",flexWrap:"wrap",pb:3,children:K.users.map((function(e){return(0,C.jsx)(F,{user:e,admin:K.groupAdmin,handleFunction:function(){return ee(e)}},e._id)}))}),(0,C.jsxs)(E.NI,{d:"flex",children:[(0,C.jsx)(Z.II,{placeholder:"Chat Name",mb:3,value:k,onChange:function(e){return b(e.target.value)}}),(0,C.jsx)(A.zx,{variant:"solid",colorScheme:"teal",ml:1,isLoading:M,onClick:X,children:"Update"})]}),(0,C.jsx)(E.NI,{children:(0,C.jsx)(Z.II,{placeholder:"Add User to group",mb:1,onChange:function(e){return Q(e.target.value)}})}),R?(0,C.jsx)(N.$,{size:"lg"}):null===D||void 0===D?void 0:D.map((function(e){return(0,C.jsx)(O,{user:e,handleFunction:function(){return H(e)}},e._id)}))]}),(0,C.jsx)(S.mz,{children:(0,C.jsx)(A.zx,{onClick:function(){return ee($)},colorScheme:"red",children:"Leave Group"})})]})]})]})},q=n(7780),U=JSON.parse('{"v":"5.4.2","fr":29.9700012207031,"ip":0,"op":50.0000020365418,"w":500,"h":500,"nm":"Comp 1","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Shape Layer 4","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[474.25,250,0],"ix":2},"a":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"n":"0p667_1_0p333_0","t":8,"s":[0,0,0],"e":[0,60,0],"to":[0,10,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"n":"0p667_1_0p333_0","t":17,"s":[0,60,0],"e":[0,0,0],"to":[0,0,0],"ti":[0,10,0]},{"t":26.0000010590017}],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[65.719,65.719],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.721415441176,0.721415441176,0.721415441176,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":0,"ix":5},"lc":1,"lj":1,"ml":4,"ml2":{"a":0,"k":4,"ix":8},"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"fl","c":{"a":0,"k":[0.54309129902,0.54309129902,0.54309129902,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-112,-2],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":900.000036657751,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Shape Layer 2","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[362,250,0],"ix":2},"a":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"n":"0p667_1_0p333_0","t":4,"s":[0,0,0],"e":[0,60,0],"to":[0,10,0],"ti":[0,0,0]},{"i":{"x":0.833,"y":0.833},"o":{"x":0.333,"y":0},"n":"0p833_0p833_0p333_0","t":13,"s":[0,60,0],"e":[0,0,0],"to":[0,0,0],"ti":[0,10,0]},{"t":22.0000008960784}],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[65.719,65.719],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.721415441176,0.721415441176,0.721415441176,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":0,"ix":5},"lc":1,"lj":1,"ml":4,"ml2":{"a":0,"k":4,"ix":8},"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"fl","c":{"a":0,"k":[0.54309129902,0.54309129902,0.54309129902,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-112,-2],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":900.000036657751,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Shape Layer 1","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[250,250,0],"ix":2},"a":{"a":1,"k":[{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"n":"0p667_1_0p333_0","t":0,"s":[0,0,0],"e":[0,60,0],"to":[0,10,0],"ti":[0,0,0]},{"i":{"x":0.667,"y":1},"o":{"x":0.333,"y":0},"n":"0p667_1_0p333_0","t":9,"s":[0,60,0],"e":[0,0,0],"to":[0,0,0],"ti":[0,10,0]},{"t":18.000000733155}],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"d":1,"ty":"el","s":{"a":0,"k":[65.719,65.719],"ix":2},"p":{"a":0,"k":[0,0],"ix":3},"nm":"Ellipse Path 1","mn":"ADBE Vector Shape - Ellipse","hd":false},{"ty":"st","c":{"a":0,"k":[0.721415441176,0.721415441176,0.721415441176,1],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":0,"ix":5},"lc":1,"lj":1,"ml":4,"ml2":{"a":0,"k":4,"ix":8},"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"fl","c":{"a":0,"k":[0.54309129902,0.54309129902,0.54309129902,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[-112,-2],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 1","np":3,"cix":2,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":900.000036657751,"st":0,"bm":0}],"markers":[]}'),V=n(6504),M=function(e){var t=e.fetchAgain,n=e.setFetchAgain,l=(0,i.useState)([]),h=(0,a.Z)(l,2),g=h[0],j=h[1],k=(0,i.useState)(!1),b=(0,a.Z)(k,2),v=b[0],y=b[1],w=(0,i.useState)(""),S=(0,a.Z)(w,2),F=S[0],z=S[1],O=(0,i.useState)(!1),I=(0,a.Z)(O,2),B=I[0],W=I[1],G=(0,i.useState)(!1),M=(0,a.Z)(G,2),P=M[0],T=M[1],Y=(0,i.useState)(!1),K=(0,a.Z)(Y,2),J=K[0],$=K[1],Q=(0,p.pm)(),X=(0,i.useContext)(o.Z),H=X.selectedChat,ee=X.setSelectedChat,te=X.user,ne=X.notification,re=X.setNotification,se={loop:!0,autoplay:!0,animationData:U,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},ae=function(){var e=(0,c.Z)(d().mark((function e(){var t,n,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,t={headers:{Authorization:"Bearer ".concat(te.token)}},y(!0),e.next=7,f().get("/api/message/".concat(H._id),t);case 7:n=e.sent,s=n.data,j(s),y(!1),console.log(s,"fetched messsages of the selected chat data"),r.emit("join chat",H._id),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0.message),Q({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:3e3,isClosable:!0,position:"bottom"});case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,c.Z)(d().mark((function e(t){var n,s,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key||!F){e.next=18;break}return r.emit("stop typing",H._id),e.prev=2,n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(te.token)}},z(""),e.next=7,f().post("/api/message",{content:F,chatId:H},n);case 7:s=e.sent,a=s.data,r.emit("new message",a),j([].concat((0,_.Z)(g),[a])),console.log(a,"sent message response data"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),console.log(e.t0.message),Q({title:"Error Occured!",description:"Failed to send the Message",status:"error",duration:3e3,isClosable:!0,position:"bottom"});case 18:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){(r=(0,V.ZP)("https://textalot.herokuapp.com")).emit("setup",te),r.on("connected",(function(){return W(!0)})),r.on("typing",(function(){return $(!0)})),r.on("stop typing",(function(){return $(!1)}))}),[]),(0,i.useEffect)((function(){ae(),s=H}),[H]),(0,i.useEffect)((function(){r.on("message recieved",(function(e){s&&s._id===e.chat._id?j([].concat((0,_.Z)(g),[e])):ne.includes(e)||(re([e].concat((0,_.Z)(ne))),n(!t),console.log(ne,"notification bell-icon check"))}))}));var oe,ce;return(0,C.jsx)(C.Fragment,{children:H?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(x.xv,{fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",fontFamily:"Work sans",d:"flex",justifyContent:{base:"space-between"},alignItems:"center",children:[(0,C.jsx)(A.hU,{d:{base:"flex",md:"none"},icon:(0,C.jsx)(u.Rp,{}),onClick:function(){return ee("")}}),g&&!H.isGroupChat?(0,C.jsxs)(C.Fragment,{children:[m(te,H.users),(0,C.jsx)(D,{user:(oe=te,ce=H.users,ce[0]._id===oe._id?ce[1]:ce[0])})]}):(0,C.jsxs)(C.Fragment,{children:[H.chatName.toUpperCase(),(0,C.jsx)(R,{fetchAgain:t,setFetchAgain:n,fetchMessages:ae})]})]}),(0,C.jsxs)(x.xu,{d:"flex",flexDir:"column",justifyContent:"flex-end",p:3,bg:"#E8E8E8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden",children:[v?(0,C.jsx)(N.$,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):(0,C.jsx)("div",{className:"messages",children:(0,C.jsx)(L,{messages:g})}),(0,C.jsxs)(E.NI,{onKeyDown:ie,id:"first-name",isRequired:!0,mt:3,children:[J?(0,C.jsx)("div",{children:(0,C.jsx)(q.Z,{options:se,height:40,width:50,style:{marginBottom:15,marginLeft:0}})}):(0,C.jsx)(C.Fragment,{}),(0,C.jsx)(Z.II,{variant:"filled",bg:"#E0E0E0",placeholder:"Enter a message..",value:F,onChange:function(e){if(z(e.target.value),B){P||(T(!0),r.emit("typing",H._id));var t=(new Date).getTime();setTimeout((function(){(new Date).getTime()-t>=3e3&&P&&(r.emit("stop typing",H._id),T(!1))}),3e3)}}})]})]})]}):(0,C.jsx)(x.xu,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%",children:(0,C.jsx)(x.xv,{fontSize:"3xl",pb:3,fontFamily:"Work sans",children:"Click on a user to start chatting"})})})},P=function(e){var t=e.fetchAgain,n=e.setFetchAgain,r=(0,i.useContext)(o.Z).selectedChat;return(0,C.jsx)(x.xu,{d:{base:r?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"white",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px",children:(0,C.jsx)(M,{fetchAgain:t,setFetchAgain:n})})},T=n(6871),Y=n(8473),K=n(4930),J=function(){var e=(0,i.useState)(""),t=(0,a.Z)(e,2),n=t[0],r=t[1],s=(0,i.useState)([]),l=(0,a.Z)(s,2),h=l[0],g=l[1],j=(0,i.useState)(!1),k=(0,a.Z)(j,2),b=k[0],v=k[1],E=(0,i.useState)(!1),F=(0,a.Z)(E,2),I=F[0],B=F[1],G=(0,i.useContext)(o.Z),L=G.user,R=G.setSelectedChat,q=G.chats,U=G.setChats,V=G.notification,M=G.setNotification,P=(0,T.s0)(),J=(0,p.pm)(),$=(0,w.qY)(),Q=$.isOpen,X=$.onOpen,H=$.onClose,ee=function(){var e=(0,c.Z)(d().mark((function e(){var t,r,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return J({title:"Please Enter something in search",status:"warning",duration:3e3,isClosable:!0,position:"top-left"}),e.abrupt("return");case 3:return e.prev=3,v(!0),t={headers:{Authorization:"Bearer ".concat(L.token)}},e.next=8,f().get("/api/user?search=".concat(n),t);case 8:r=e.sent,s=r.data,v(!1),g(s),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0.message),J({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:3e3,isClosable:!0,position:"bottom-left"});case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=(0,c.Z)(d().mark((function e(t){var n,r,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,B(!0),n={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(L.token)}},e.next=5,f().post("/api/chat",{userId:t},n);case 5:r=e.sent,s=r.data,q.find((function(e){return e._id===s._id}))||U([s].concat((0,_.Z)(q))),R(s),console.log(s,"access new/existing chat response data"),B(!1),H(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0.message),J({title:"Error fetching the chat",description:e.t0.message,status:"error",duration:3e3,isClosable:!0,position:"bottom-left"});case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,C.jsxs)(i.Fragment,{children:[(0,C.jsxs)(x.xu,{d:"flex",justifyContent:"space-between",alignItems:"center",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px",borderColor:"purple.600",bg:"yellow.400",color:"black",children:[(0,C.jsx)(W.u,{label:"Search Users to chat",hasArrow:!0,placement:"bottom-end",children:(0,C.jsxs)(A.zx,{variant:"ghost",bg:"blue.700",onClick:X,color:"white",_hover:{background:"purple.800",color:"yellow.400"},_active:{background:"purple.800",color:"yellow.400"},children:[(0,C.jsx)("i",{className:"fas fa-search"}),(0,C.jsx)(x.xv,{d:{base:"none",md:"flex"},px:4,fontWeight:"bold",children:"Search User"})]})}),(0,C.jsx)(x.xv,{fontSize:"3xl",fontFamily:"Work sans bold",fontWeight:"bold",color:"purple.700",children:"Text-A-Lot"}),(0,C.jsxs)("div",{children:[(0,C.jsxs)(Y.v2,{children:[(0,C.jsxs)(Y.j2,{p:1,children:[(0,C.jsx)(K.ZP,{count:V.length,effect:K.Qm.SCALE}),(0,C.jsx)(u.Dk,{fontSize:"2xl",m:1,color:"blue.700"})]}),(0,C.jsxs)(Y.qy,{pl:2,children:[!V.length&&"No New Messages",V.map((function(e){return(0,C.jsx)(Y.sN,{onClick:function(){R(e.chat),M(V.filter((function(t){return t!==e})))},children:e.chat.isGroupChat?"New Message in ".concat(e.chat.chatName):"New Message from ".concat(m(L,e.chat.users))},e._id)}))]})]}),(0,C.jsxs)(Y.v2,{children:[(0,C.jsx)(Y.j2,{as:A.zx,bg:"blue.700",rightIcon:(0,C.jsx)(u.v4,{}),_hover:{background:"purple.800",color:"yellow.400"},_active:{background:"purple.800",color:"yellow.400"},children:(0,C.jsx)(z.qE,{size:"sm",cursor:"pointer",name:L.name,borderColor:"black",borderWidth:"2px",bg:"yellow.400",color:"black"})}),(0,C.jsxs)(Y.qy,{bg:"purple.600",borderColor:"black",borderWidth:"2px",children:[(0,C.jsxs)(D,{user:L,children:[(0,C.jsx)(Y.sN,{fontWeight:"bold",color:"black",_hover:{background:"yellow.400"},children:"My Profile"})," "]}),(0,C.jsx)(Y.R,{}),(0,C.jsx)(Y.sN,{fontWeight:"bold",color:"black",onClick:function(){localStorage.removeItem("userInformation"),P("/")},_hover:{background:"yellow.400"},children:"Logout"})]})]})]})]}),(0,C.jsxs)(S.dy,{placement:"left",onClose:H,isOpen:Q,children:[(0,C.jsx)(S.P1,{}),(0,C.jsxs)(S.sc,{children:[(0,C.jsx)(S.OX,{borderBottomWidth:"1px",children:"Search Users"}),(0,C.jsxs)(S.Ng,{children:[(0,C.jsxs)(x.xu,{d:"flex",pb:2,children:[(0,C.jsx)(Z.II,{placeholder:"Search by name or email",mr:2,value:n,onChange:function(e){return r(e.target.value)}}),(0,C.jsx)(A.zx,{onClick:ee,children:"Go"})]}),b?(0,C.jsx)(y,{}):null===h||void 0===h?void 0:h.map((function(e){return(0,C.jsx)(O,{user:e,handleFunction:function(){return te(e._id)}},e._id)})),I&&(0,C.jsx)(N.$,{ml:"auto",d:"flex"})]})]})]})]})},$=function(){var e=(0,i.useState)(!1),t=(0,a.Z)(e,2),n=t[0],r=t[1],s=(0,i.useContext)(o.Z).user;return(0,C.jsxs)("div",{style:{width:"100%"},children:[s&&(0,C.jsx)(J,{}),(0,C.jsxs)(x.xu,{d:"flex",justifyContent:"space-between",width:"100%",h:"90.5vh",p:"12px",children:[s&&(0,C.jsx)(B,{fetchAgain:n}),s&&(0,C.jsx)(P,{fetchAgain:n,setFetchAgain:r})]})]})}}}]);
//# sourceMappingURL=393.5b53fb67.chunk.js.map